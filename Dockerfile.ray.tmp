FROM rayproject/ray:2.9.0
RUN pip install --no-cache-dir prometheus-client requests psutil
RUN mkdir -p /models /app/metrics /app/ray_serve && chmod -R 777 /models /app
COPY metrics/exporter.py /app/metrics/exporter.py
COPY ray_serve/llama_serve.py /app/ray_serve/llama_serve.py
RUN chmod +x /app/metrics/exporter.py
WORKDIR /app/ray_serve
CMD ["python", "-m", "ray.serve", "run", "llama_serve:app"]